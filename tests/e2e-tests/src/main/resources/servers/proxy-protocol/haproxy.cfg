# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

global
    log stdout format raw local0

defaults
    log global
    mode tcp
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms

# Clients connecting here should be successfully proxied to an acceptor with proxyEnabled=true using version 1 of the PROXY Protocol.
frontend V1
    bind *:51617
    default_backend V1-backend

backend V1-backend
    server broker broker:61617 send-proxy

# Clients connecting here should be successfully proxied to an acceptor with proxyProtocolEnabled=true using version 2 of the PROXY Protocol.
frontend V2
    bind *:51627
    default_backend V2-backend

backend V2-backend
    server broker broker:61617 send-proxy-v2

# Clients connecting here should be successfully proxied to an acceptor with proxyProtocolEnabled=true & sslEnabled=true using version 1 of the PROXY Protocol.
frontend ssl
    bind *:51618
    default_backend ssl-backend

backend ssl-backend
    server broker broker:61618 send-proxy

# Clients connecting here should be *unsuccessfully* proxied to an acceptor using the default proxyProtocolEnabled value (i.e. false).
frontend invalid
    bind *:51616
    default_backend invalid-backend

backend invalid-backend
    server broker broker:61616 send-proxy
